# Запуск онлайн-режима (2+ игроков)

Коротко: да, для онлайн-матча между несколькими игроками нужен запущенный сервер матча (`match-server`), к которому могут подключиться все клиенты.

## Что обязательно

- Фронтенд (браузерная игра).
- `match-server` (WebSocket-сервер комнат) на порту `2567`.

Без `match-server` онлайн-комнаты не работают.

## Что опционально

- `nakama` + `postgres` нужны для leaderboard/RPC и серверной записи результатов.
- Для самой гонки в комнате (join/create, input, snapshot) достаточно фронтенда + `match-server`.

## Вариант 1 (рекомендуется): через Docker

```bash
docker compose up --build
```

После запуска:

- Игра: `http://localhost:5500` (или `http://localhost:8080`)
- Match-server health: `http://localhost:2567/healthz`

## Вариант 2: без Docker (быстрый локальный тест)

1. В корне проекта поднять фронт:

```bash
npx serve . -l 5500
```

2. В отдельном терминале поднять `match-server`:

```bash
cd match-server
npm install
npm start
```

3. Открыть `http://localhost:5500`.

## Как тестировать 2+ игроков

- На одном ПК: открыть 2+ вкладки/окна браузера.
- На разных устройствах в одной сети:
  - сервер должен быть запущен на хосте;
  - устройства должны открывать фронт и иметь доступ к порту `2567` хоста.
- Через интернет:
  - нужен публичный адрес/домен сервера;
  - проброс порта `2567` (и порта фронта);
  - при `https` на фронте матч-сокет должен быть `wss`.

## Мини-чеклист перед тестом

- `http://<host>:2567/healthz` отвечает `ok: true`.
- Все клиенты открывают одну и ту же сборку фронта.
- Кнопка «Играть онлайн» открывает выбор змеи/трассы и подключает к комнате.
